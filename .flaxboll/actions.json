{"1753734913335":{"actionType":"saveAll","createdAt":"1753734913335","actionID":"1753734913335","userID":"#TEMP","path":"system.capsules.4e11074c-5b8c-4be9-b431-175ac9e313fb.capsUseCodeInfo.capsUseDescription.en","oldValue":"() => {\n  const email = tools.getCtData(\"sc.adm.login.forms.email\");\n  const password = tools.getCtData(\"sc.adm.login.forms.password\");\n  const users = tools.getCtData(\"sc.adm.login.db.users\") || [];\n\n  if (!email || email.trim() === \"\") {\n    console.log(\"Por favor, preencha o e-mail.\");\n    return;\n  }\n\n  if (!password || password.trim() === \"\") {\n    console.log(\"Por favor, preencha a senha.\");\n    return;\n  }\n\n  const userMatch = users.find(\n    (user) => user.userEmail === email && user.userPassword === password\n  );\n\n  if (!userMatch) {\n    console.log(\"E-mail ou senha incorretos.\");\n    return;\n  }\n\n  // Salva o usuário logado na sessão\n  const sessionPath = \"sc.adm.session.user\";\n  const sessionData = { keyPath: [sessionPath], value: [userMatch] };\ntools.functions.setVar({ args: \"\", pass: sessionData });\n\n  console.log(\"Login OK\");\n\n  tools.goTo(\"admDash\");\n}\n","newValue":"() => {\n  const email = tools.getCtData(\"sc.adm.login.forms.email\");\n  const password = tools.getCtData(\"sc.adm.login.forms.password\");\n  const users = tools.getCtData(\"sc.adm.login.db.users\") || [];\n\n  const setMessage = (msg) => {\n    tools.functions.setVar({\n      args: '',\n      pass: { keyPath: [\"sc.adm.login.message\"], value: [msg] }\n    });\n  };\n\n  if (!email || email.trim() === \"\") {\n    setMessage(\"Por favor, preencha o e-mail.\");\n    return;\n  }\n\n  if (!password || password.trim() === \"\") {\n    setMessage(\"Por favor, preencha a senha.\");\n    return;\n  }\n\n  const userMatch = users.find(\n    (user) => user.userEmail === email && user.userPassword === password\n  );\n\n  if (!userMatch) {\n    setMessage(\"E-mail ou senha incorretos.\");\n    return;\n  }\n\n  const sessionPath = \"sc.adm.session.user\";\n  const sessionData = { keyPath: [sessionPath], value: [userMatch] };\n  tools.functions.setVar({ args: \"\", pass: sessionData });\n\n  setMessage(\"Login realizado com sucesso!\");\n\n  tools.goTo(\"admDash\");\n\nsetMessage(\"\");\n}"}}