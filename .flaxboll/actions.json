{"1770829523676":{"actionType":"saveAll","createdAt":"1770829523676","actionID":"1770829523676","userID":"#TEMP","path":"system.capsules.397e4980-59b2-4ca8-bb9b-500ae45ff6da.capsUseCodeInfo.capsUseInputs.sss_custom_caps-0.capsIptTxtValue","oldValue":"() => {\n  // 1. Pega o produto\n  const product = tools.getCtData(\"sc.C2.forms.iptsChanges\");\n  if (!product) {\n    console.log(\"Nenhum produto encontrado em sc.C2.forms.iptsChanges\");\n    return;\n  }\n\n  // 2. Pega a lista atual do carrinho (array)\n  const currentCart = tools.getCtData(\"sc.C4.forms.iptsChanges.products\") || [];\n\n  // 3. Cria uma nova lista com o item adicionado\n  const updatedCart = [...currentCart, product];\n\n  // 4. Salva no state do carrinho\n  tools.functions.setVar({\n    args: \"\",\n    pass: {\n      keyPath: [\"sc.C4.forms.iptsChanges.products\"],\n      value: updatedCart,\n    },\n  });\n\n  console.log(\"ðŸ›’ Produto adicionado ao carrinho:\", product);\n  console.log(\"ðŸ“¦ Carrinho atualizado:\", updatedCart);\n\n  // 5. Navega para a tela do carrinho\n  tools.goTo(\"c4cart\");\n}","newValue":"() => {\n  // Pega o produto atual\n  const product = tools.getCtData(\"sc.C2.forms.iptsChanges\");\n  if (!product) {\n    console.log(\"Nenhum produto encontrado\");\n    return;\n  }\n\n  // Pega o valor atual do carrinho\n  let currentCart = tools.getCtData(\"sc.C4.forms.iptsChanges.products\") || [];\n\n  // Garantir que SEMPRE seja array\n  if (!Array.isArray(currentCart)) {\n    currentCart = [currentCart];\n  }\n\n  // Novo carrinho\n  const updatedCart = [...currentCart, product];\n\n  // Salvar no state\n  tools.functions.setVar({\n    args: \"\",\n    pass: {\n      keyPath: [\"sc.C4.forms.iptsChanges.products\"],\n      value: updatedCart,\n    },\n  });\n\n  console.log(\"ðŸ›’ Produto adicionado ao carrinho:\", product);\n  console.log(\"ðŸ“¦ Carrinho atualizado:\", updatedCart);\n\n  // Navegar\n  tools.goTo(\"c4cart\");\n}\n"}}