{"1767359793501":{"actionType":"saveAll","createdAt":"1767359793501","actionID":"1767359793501","userID":"#TEMP","path":"system.capsules.59a9aa1e-050b-4001-abfe-7cd761b6e7aa.capsUseCodeInfo.capsUseLabel.en","oldValue":"btnSaveProdutc","newValue":"btnSaveOrder"},"1767359793502":{"actionType":"saveAll","createdAt":"1767359793502","actionID":"1767359793502","userID":"#TEMP","path":"system.capsules.1e585b87-5da8-4970-9c32-1834a1ff21a7.capsUseCodeInfo.capsUseInputs.sss_custom_caps-0.capsIptTxtValue","oldValue":"async () => {\n  // Lista de vari√°veis a verificar\n  const requiredFields = [\n    \"sc.a5b.editData.order.order\",\n    \"sc.a5b.editData.order.date\",\n    \"sc.a5b.editData.order.total\",\n    \"sc.a5b.editData.order.status\",\n  ];\n\n  const getVal = (path) => tools.getCtData(path);\n\n  const allFilled = requiredFields.every((path) => {\n    const value = getVal(path);\n    return value !== undefined && value !== null && value !== \"\";\n  });\n\n  // ‚õî SE FALTAR ALGUM CAMPO, PARA O FLUXO AQUI\n  if (!allFilled) {\n    console.log(\"‚ùå Existem campos obrigat√≥rios vazios.\");\n    return;\n  }\n\n  console.log(\"‚úî Todos os campos preenchidos! Atualizando produto...\");\n\n  // üî• INICIALIZA√á√ÉO FIREBASE (necess√°ria!)\n  let fbInit = tools.getCtData(\"all.temp.fireInit\");\n\n  if (!fbInit) {\n    const { initializeApp, getApps } = await import(\"firebase/app\");\n    const cfg = tools.getCtData(\"all.temp.fireConfig\");\n\n    fbInit = getApps().length ? getApps()[0] : initializeApp(cfg);\n\n    tools.setData({\n      path: \"all.temp.fireInit\",\n      value: fbInit,\n    });\n  }\n\n  // Importa Firestore\n  const { getFirestore, doc, updateDoc } = await import(\"firebase/firestore\");\n  const db = getFirestore(fbInit);\n\n  // ID do documento\n  const docId = getVal(\"sc.a5b.editData.order.docId\");\n  if (!docId) {\n    console.log(\"‚ùå Nenhum docId encontrado.\");\n    return;\n  }\n\n  // Dados completos do produto\n  const orderData = getVal(\"sc.a5b.editData.order\");\n\n  try {\n    // üîÑ Update no documento\n    await updateDoc(doc(db, \"ordersEcommerce\", docId), orderData);\n\n    console.log(\"‚úî Order atualizado com sucesso!\");\n\n    // üßπ Limpar dados depois do update\n    tools.setData({\n      path: \"sc.a5b.editData.order\",\n      value: {},\n    });\n\n    console.log(\"üßπ Vari√°veis limpas ap√≥s o update.\");\n\n    // ‚úÖ Redirecionar para a tela a5AdmOrders\n    tools.goTo(\"as\");\n  } catch (err) {\n    console.log(\"üî• Erro ao atualizar:\", err);\n  }\n}","newValue":"async () => {\n  // Lista de vari√°veis a verificar\n  const requiredFields = [\n    \"sc.a5b.editData.order.order\",\n    \"sc.a5b.editData.order.date\",\n    \"sc.a5b.editData.order.total\",\n    \"sc.a5b.editData.order.status\",\n  ];\n\n  const getVal = (path) => tools.getCtData(path);\n\n  const allFilled = requiredFields.every((path) => {\n    const value = getVal(path);\n    return value !== undefined && value !== null && value !== \"\";\n  });\n\n  // ‚õî SE FALTAR ALGUM CAMPO, PARA O FLUXO AQUI\n  if (!allFilled) {\n    console.log(\"‚ùå Existem campos obrigat√≥rios vazios.\");\n    return;\n  }\n\n  console.log(\"‚úî Todos os campos preenchidos! Atualizando produto...\");\n\n  // üî• INICIALIZA√á√ÉO FIREBASE (necess√°ria!)\n  let fbInit = tools.getCtData(\"all.temp.fireInit\");\n\n  if (!fbInit) {\n    const { initializeApp, getApps } = await import(\"firebase/app\");\n    const cfg = tools.getCtData(\"all.temp.fireConfig\");\n\n    fbInit = getApps().length ? getApps()[0] : initializeApp(cfg);\n\n    tools.setData({\n      path: \"all.temp.fireInit\",\n      value: fbInit,\n    });\n  }\n\n  // Importa Firestore\n  const { getFirestore, doc, updateDoc } = await import(\"firebase/firestore\");\n  const db = getFirestore(fbInit);\n\n  // ID do documento\n  const docId = getVal(\"sc.a5b.editData.order.docId\");\n  if (!docId) {\n    console.log(\"‚ùå Nenhum docId encontrado.\");\n    return;\n  }\n\n  // Dados completos do produto\n  const orderData = getVal(\"sc.a5b.editData.order\");\n\n  try {\n    // üîÑ Update no documento\n    await updateDoc(doc(db, \"ordersEcommerce\", docId), orderData);\n\n    console.log(\"‚úî Order atualizado com sucesso!\");\n\n    // üßπ Limpar dados depois do update\n    tools.setData({\n      path: \"sc.a5b.editData.order\",\n      value: {},\n    });\n\n    console.log(\"üßπ Vari√°veis limpas ap√≥s o update.\");\n\n    // ‚úÖ Redirecionar para a tela a5AdmOrders\n    tools.goTo(\"b5mobileOrders\");\n  } catch (err) {\n    console.log(\"üî• Erro ao atualizar:\", err);\n  }\n}"}}